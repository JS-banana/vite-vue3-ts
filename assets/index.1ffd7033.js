var cn=Object.defineProperty,dn=Object.defineProperties;var fn=Object.getOwnPropertyDescriptors;var ve=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var Be=Math.pow,Qe=(e,t,n)=>t in e?cn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$=(e,t)=>{for(var n in t||(t={}))Ke.call(t,n)&&Qe(e,n,t[n]);if(ve)for(var n of ve(t))Ne.call(t,n)&&Qe(e,n,t[n]);return e},Ee=(e,t)=>dn(e,fn(t));var le=(e,t)=>{var n={};for(var o in e)Ke.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&ve)for(var o of ve(e))t.indexOf(o)<0&&Ne.call(e,o)&&(n[o]=e[o]);return n};var Te=(e,t,n)=>new Promise((o,u)=>{var g=d=>{try{r(n.next(d))}catch(y){u(y)}},h=d=>{try{r(n.throw(d))}catch(y){u(y)}},r=d=>d.done?o(d.value):Promise.resolve(d.value).then(g,h);r((n=n.apply(e,t)).next())});import{e as we,d as te,c as j,r as b,R as mn,ao as vn,m as L,j as H,k as A,q as ee,S as oe,W as ae,ap as pn,t as pe,a4 as Ue,aa as Ce,U as qe,T as Se,ak as _n,am as gn,aq as hn,ar as yn,al as bn,as as En,_ as Tn,an as wn,at as Cn,ad as Sn,p as On,i as We,w as Oe,b as In,u as kn,f as Ie,h as Rn,I as Ye,V as ke,au as $n,D as Pn,av as Fn,ae as Ln,aw as Dn}from"./antdv.0af80524.js";import{_ as ze,b as jn}from"./index.f0771088.js";const An=we({props:["hiddenFilter","button","items","model"],emits:["onSearch"],setup(e,{emit:t}){const n=te(e.model||{}),o=j(()=>(e.items||[]).map(h=>$({type:"input"},h))),u=()=>{t("onSearch")},g=b(e.hiddenFilter);return mn(()=>{!e.button&&!e.items&&(g.value=!0)}),{formModel:n,getItems:o,hasHidden:g,handleSubmit:u}}}),Mn={key:0,class:"text"},Kn=Ue("\u67E5\u8BE2");function Nn(e,t,n,o,u,g){const h=_n,r=gn,d=hn,y=yn,_=bn,s=En,k=Tn,S=wn,T=Cn,w=Sn,K=vn("auth");return e.hasHidden?Ce("",!0):(L(),H(w,{key:0,"body-style":{padding:"0 0 24px 0"},bordered:!1},{default:A(()=>[ee(T,{class:"form-container",layout:"horizontal",model:e.formModel},{default:A(()=>[ee(S,{type:"flex"},{default:A(()=>[e.button?(L(),H(r,{key:0,flex:"100px"},{default:A(()=>{var l;return[e.button.type==="text"?(L(),oe("span",Mn,ae(e.button.label),1)):pn((L(),H(h,pe({key:1},e.button,{onClick:(l=e.button)==null?void 0:l.onClick}),{default:A(()=>[Ue(ae(e.button.label),1)]),_:1},16,["onClick"])),[[K,e.button.auth]])]}),_:1})):Ce("",!0),ee(r,{flex:"auto",class:"rowE"},{default:A(()=>[ee(k,null,{default:A(()=>[(L(!0),oe(Se,null,qe(e.getItems,l=>(L(),H(s,{key:l.name,name:l.name},{default:A(()=>[l.type==="select"?(L(),H(d,pe({key:0,key:`select-${l.name}`},l,{value:e.formModel[l.name],"onUpdate:value":R=>e.formModel[l.name]=R,class:"default-select-w"}),null,16,["value","onUpdate:value"])):l.type==="date"?(L(),H(y,pe({key:1,key:`date-${l.name}`},l,{value:e.formModel[l.name],"onUpdate:value":R=>e.formModel[l.name]=R,class:"default-select-w"}),null,16,["value","onUpdate:value"])):(L(),H(_,pe({key:2},l,{key:`input-${l.name}`,value:e.formModel[l.name],"onUpdate:value":R=>e.formModel[l.name]=R,onSearch:e.handleSubmit,class:"default-search-w"}),{enterButton:A(()=>[ee(h,{type:"primary"},{default:A(()=>[Kn]),_:1})]),_:2},1040,["value","onUpdate:value","onSearch"]))]),_:2},1032,["name"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}))}var Bn=ze(An,[["render",Nn],["__scopeId","data-v-26216c94"]]);const Qn={},Re=Symbol("GLOBAL_OPTIONS_PROVIDE_KEY"),Ve=()=>Qn;we({name:"RequestConfig",props:{config:{type:Object,required:!0}},setup(e,{slots:t}){const{config:n}=e;return On(Re,n),()=>{var o;return(o=t.default)===null||o===void 0?void 0:o.call(t)}}});const Un=Object.prototype.toString,He=e=>Un.call(e),qn=e=>He(e)==="[object String]",Ge=e=>He(e)==="[object Object]",Wn=e=>Array.isArray(e),ie=e=>e!==null&&typeof e=="object",Yn=e=>ie(e)&&_e(e.then)&&_e(e.catch),_e=e=>e instanceof Function,ge=e=>e==null,$e=typeof window=="undefined",Pe=()=>{var e,t;return!$e&&((e=window)===null||e===void 0||(t=e.document)===null||t===void 0?void 0:t.visibilityState)==="visible"},Je=()=>{var e,t,n;return(e=!$e&&((t=window)===null||t===void 0||(n=t.navigator)===null||n===void 0?void 0:n.onLine))!==null&&e!==void 0?e:!0},zn=e=>{const t={};return Object.keys(e).forEach(n=>{t[n]=kn(e[n])}),t},ue=Promise.resolve(null),Xe=(...e)=>Te(void 0,null,function*(){const t=yield fetch(...e);if(t.ok)return t.json();throw new Error(t.statusText)}),Ze=(e,t,n=void 0)=>{const o=t.replace(/\[(\d+)\]/g,".$1").split(".");let u=e;for(const g of o)if(u=Object(u)[g],u===void 0)return n;return u};function Vn(e,t){const n=Object.assign({},e);for(const o of t)delete n[o];return n}const xe=(e,t=!1)=>{const n=`Warning: [vue-request] ${e}`;if(t)return new Error(n);console.error(n)},Hn=(e,t)=>{let n=!1;return(...o)=>{n||(n=!0,e(...o),setTimeout(()=>{n=!1},t))}};var Fe;const en=new Set,nn=new Set,tn=new Set,he=(e,t)=>{let n;switch(e){case"FOCUS_LISTENER":n=en;break;case"RECONNECT_LISTENER":n=tn;break;case"VISIBLE_LISTENER":n=nn;break}if(!n.has(t))return n.add(t),()=>{n.delete(t)}},Le=e=>{e.forEach(t=>{t()})};!$e&&(Fe=window)!==null&&Fe!==void 0&&Fe.addEventListener&&(window.addEventListener("visibilitychange",()=>{Pe()&&Le(nn)},!1),window.addEventListener("focus",()=>Le(en),!1),window.addEventListener("online",()=>Le(tn),!1));function on(e,t,n){let o,u,g,h,r,d,y=0,_=!1,s=!1,k=!0;const S=!t&&t!==0&&typeof window.requestAnimationFrame=="function";if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0,ie(n)&&(_=!!n.leading,s="maxWait"in n,g=s?Math.max(+n.maxWait||0,t):g,k="trailing"in n?!!n.trailing:k);function T(c){const m=o,O=u;return o=u=void 0,y=c,h=e.apply(O,m),h}function w(c,m){return S?(window.cancelAnimationFrame(r),window.requestAnimationFrame(c)):setTimeout(c,m)}function K(c){if(S)return window.cancelAnimationFrame(c);clearTimeout(c)}function l(c){return y=c,r=w(p,t),_?T(c):h}function R(c){const m=c-d,O=c-y,P=t-m;return s?Math.min(P,g-O):P}function i(c){const m=c-d,O=c-y;return d===void 0||m>=t||m<0||s&&O>=g}function p(){const c=Date.now();if(i(c))return D(c);r=w(p,R(c))}function D(c){return r=void 0,k&&o?T(c):(o=u=void 0,h)}function N(){r!==void 0&&K(r),y=0,o=d=u=r=void 0}function z(){return r===void 0?h:D(Date.now())}function B(){return r!==void 0}function M(...c){const m=Date.now(),O=i(m);if(o=c,u=this,d=m,O){if(r===void 0)return l(d);if(s)return r=w(p,t),T(d)}return r===void 0&&(r=w(p,t)),h}return M.cancel=N,M.flush=z,M.pending=B,M}function an(e,t){for(const n in t)if(t[n]!==void 0){if(!ie(t[n])||!ie(e[n])||!(n in e)){e[n]=t[n];continue}(Ge(t[n])||Wn(t[n]))&&an(e[n],t[n])}}function rn(e,...t){const n=Object.assign({},e);if(!t.length)return n;for(const o of t)an(n,o);return n}function Gn(e,t,n){let o=!0,u=!0;if(typeof e!="function")throw new TypeError("Expected a function");return ie(n)&&(o="leading"in n?!!n.leading:o,u="trailing"in n?!!n.trailing:u),on(e,t,{leading:o,trailing:u,maxWait:t})}const Jn=(e,t)=>n=>{Object.keys(n).forEach(o=>{e[o].value=n[o]}),t.forEach(o=>o(e))},ye=(e,t,n)=>{var o,u,g;const{initialAutoRunFlag:h,initialData:r,loadingDelay:d,pollingInterval:y,debounceInterval:_,debounceOptions:s,throttleInterval:k,throttleOptions:S,pollingWhenHidden:T,pollingWhenOffline:w,errorRetryCount:K,errorRetryInterval:l,stopPollingWhenHiddenOrOffline:R,refreshOnWindowFocus:i,refocusTimespan:p,updateCache:D,formatResult:N,onSuccess:z,onError:B,onBefore:M,onAfter:c}=t,m=b(0),O=b((o=n==null?void 0:n.loading)!==null&&o!==void 0?o:!1),P=b((u=n==null?void 0:n.data)!==null&&u!==void 0?u:r),Q=b(n==null?void 0:n.error),q=b((g=n==null?void 0:n.params)!==null&&g!==void 0?g:[]),v=Jn({loading:O,data:P,error:Q,params:q},[f=>D(f)]),E=()=>{m.value=0},W=b(0),G=b(),J=b(),ne=b(),ce=()=>{G.value&&G.value(),ne.value&&ne.value(),J.value&&J.value()},se=()=>{let f;return d&&(f=setTimeout(v,d,{loading:!0})),()=>f&&clearTimeout(f)},de=f=>{if(Q.value&&K!==0)return;let F;if(!ge(y)&&y>=0)if((T||Pe())&&(w||Je()))F=setTimeout(f,y);else{R.value=!0;return}return()=>F&&clearTimeout(F)},fe=j(()=>{if(l)return l;const f=1e3,F=1,U=9,x=Math.floor(Math.random()*Be(2,Math.min(m.value,U))+F);return f*x}),a=f=>{let F;const U=K===-1,x=m.value<K;return Q.value&&(U||x)&&(U||(m.value+=1),F=setTimeout(f,fe.value)),()=>F&&clearTimeout(F)},I=(...f)=>{v({loading:!d,params:f}),ne.value=se(),W.value+=1;const F=W.value;return M==null||M(f),e(...f).then(U=>{if(F===W.value){const x=N?N(U):U;return v({data:x,loading:!1,error:void 0}),z&&z(x,f),E(),x}return ue}).catch(U=>(F===W.value&&(v({data:void 0,loading:!1,error:U}),B&&B(U,f),console.error(U)),ue)).finally(()=>{F===W.value&&(ne.value(),J.value=a(()=>I(...f)),G.value=de(()=>I(...f)),c==null||c(f))})},C=!ge(_)&&on(I,_,s),Y=!ge(k)&&Gn(I,k,S),V=(...f)=>(ce(),!h.value&&C?(C(...f),ue):Y?(Y(...f),ue):(E(),I(...f))),X=()=>{W.value+=1,v({loading:!1}),C&&C.cancel(),Y&&Y.cancel(),ce()},Z=()=>V(...q.value),un=f=>{const F=_e(f)?f(P.value):f;v({data:F})},je=[],me=f=>{f&&je.push(f)},Ae=()=>{R.value&&(T||Pe())&&(w||Je())&&(Z(),R.value=!1)};T||me(he("VISIBLE_LISTENER",Ae)),w||me(he("RECONNECT_LISTENER",Ae));const Me=Hn(Z,p);return i&&(me(he("VISIBLE_LISTENER",Me)),me(he("FOCUS_LISTENER",Me))),{loading:O,data:P,error:Q,params:q,run:V,cancel:X,refresh:Z,mutate:un,unmount:()=>{je.forEach(f=>f())}}},be=new Map,De=e=>{if(ge(e))return;const t=be.get(e);if(!!t)return{data:t.data,cacheTime:t.cacheTime}},Xn=(e,t,n)=>{const o=be.get(e);o!=null&&o.timer&&clearTimeout(o.timer);const u=setTimeout(()=>be.delete(e),n);be.set(e,{data:t,timer:u,cacheTime:new Date().getTime()})},re="__QUERY_DEFAULT_KEY__";function Zn(e,t){const n=We(Re,{}),fe=$($($({},Ve()),n),t),{cacheKey:o,defaultParams:u=[],manual:g=!1,ready:h=b(!0),refreshDeps:r=[],loadingDelay:d=0,pollingWhenHidden:y=!1,pollingWhenOffline:_=!1,refreshOnWindowFocus:s=!1,refocusTimespan:k=5e3,cacheTime:S=6e5,staleTime:T=0,errorRetryCount:w=0,errorRetryInterval:K=0,queryKey:l}=fe,R=le(fe,["cacheKey","defaultParams","manual","ready","refreshDeps","loadingDelay","pollingWhenHidden","pollingWhenOffline","refreshOnWindowFocus","refocusTimespan","cacheTime","staleTime","errorRetryCount","errorRetryInterval","queryKey"]),i=b(!1),p=b(!1),N=$({initialAutoRunFlag:p,loadingDelay:d,pollingWhenHidden:y,pollingWhenOffline:_,stopPollingWhenHiddenOrOffline:i,cacheKey:o,errorRetryCount:w,errorRetryInterval:K,refreshOnWindowFocus:s,refocusTimespan:k,updateCache:a=>{var I,C;if(!o)return;const Y=(I=De(o))===null||I===void 0?void 0:I.data,V=Y==null?void 0:Y.queries,X=zn(a),Z=(C=l==null?void 0:l(...a.params.value))!==null&&C!==void 0?C:re;Xn(o,{queries:Ee($({},V),{[Z]:$($({},V==null?void 0:V[Z]),X)}),latestQueriesKey:Z},S)}},Vn(R,["pagination","listKey"])),z=b(!1),B=b(),M=b(),c=b(),m=te({[re]:te(ye(e,N))}),O=b(re),P=j(()=>{var a;return(a=m[O.value])!==null&&a!==void 0?a:{}});if(Oe(P,a=>{z.value=a.loading,B.value=a.data,M.value=a.error,c.value=a.params},{immediate:!0,deep:!0}),o){var Q;const a=De(o);a!=null&&(Q=a.data)!==null&&Q!==void 0&&Q.queries&&(Object.keys(a.data.queries).forEach(I=>{const C=a.data.queries[I];m[I]=te(ye(e,N,{loading:C.loading,params:C.params,data:C.data,error:C.error}))}),a.data.latestQueriesKey&&(O.value=a.data.latestQueriesKey))}const q=b(),v=b(!1),E=(...a)=>{var I;if(!h.value&&!v.value)return q.value=a,ue;const C=(I=l==null?void 0:l(...a))!==null&&I!==void 0?I:re;return m[C]||(m[C]=te(ye(e,N))),O.value=C,P.value.run(...a)},W=()=>{G(),O.value=re,m[re]=te(ye(e,N))},G=()=>{Object.keys(m).forEach(a=>{m[a].cancel(),m[a].unmount(),delete m[a]})},J=()=>P.value.cancel(),ne=()=>P.value.refresh(),ce=a=>P.value.mutate(a);if(!g){var se;p.value=!0;const a=De(o),I=(se=a==null?void 0:a.data.queries)!==null&&se!==void 0?se:{},C=a&&(T===-1||a.cacheTime+T>new Date().getTime()),Y=Object.keys(I).length>0;C||(Y?Object.keys(m).forEach(V=>{var X;(X=m[V])===null||X===void 0||X.refresh()}):E(...u)),p.value=!1}const de=b();return de.value=Oe(h,a=>{v.value=!0,a&&q.value&&(E(...q.value),de.value())},{flush:"sync"}),r.length&&Oe(r,()=>{!g&&P.value.refresh()}),In(()=>{G()}),{loading:z,data:B,error:M,params:c,cancel:J,refresh:ne,mutate:ce,run:E,reset:W,queries:m}}const sn=e=>(...t)=>{if(_e(e))return sn(e(...t))();if(Yn(e))return e;if(Ge(e)){const n=e,{url:o}=n,u=le(n,["url"]);return Xe(o,u)}else{if(qn(e))return Xe(e);throw xe("Unknown service type",!0)}};function xn(e,t){var n,o;const u=sn(e),g={pagination:{currentKey:"current",pageSizeKey:"pageSize",totalKey:"total",totalPageKey:"totalPage"}},h=We(Re,{}),Q=rn(g,{pagination:(n=Ve().pagination)!==null&&n!==void 0?n:{}},{pagination:(o=h.pagination)!==null&&o!==void 0?o:{}},t!=null?t:{}),{pagination:{currentKey:r,pageSizeKey:d,totalKey:y,totalPageKey:_},queryKey:s}=Q,k=le(Q,["pagination","queryKey"]);s&&xe("usePagination does not support concurrent request");const S=rn({defaultParams:[{[r]:1,[d]:10}]},k),q=Zn(u,S),{data:T,params:w,queries:K,run:l,reset:R}=q,i=le(q,["data","params","queries","run","reset"]),p=v=>{const[E,...W]=w.value,J=[$($({},E),v),...W];l(...J)},D=v=>{p({[r]:v})},N=v=>{p({[d]:v})},z=(v,E)=>{p({[r]:v,[d]:E})},B=b(!1),M=()=>Te(this,null,function*(){const{defaultParams:v,manual:E}=S;R(),E||(B.value=!0,yield l(...v),B.value=!1)}),c=j(()=>Ze(T.value,y,0)),m=j({get:()=>{var v,E;return(v=(E=w.value[0])===null||E===void 0?void 0:E[r])!==null&&v!==void 0?v:S.defaultParams[0][r]},set:v=>{D(v)}}),O=j({get:()=>{var v,E;return(v=(E=w.value[0])===null||E===void 0?void 0:E[d])!==null&&v!==void 0?v:S.defaultParams[0][d]},set:v=>{N(v)}}),P=j(()=>Ze(T.value,_,Math.ceil(c.value/O.value)));return $({data:T,params:w,current:m,pageSize:O,total:c,totalPage:P,reloading:B,run:l,changeCurrent:D,changePageSize:N,changePagination:z,reload:M},i)}const et="YYYY-MM-DD HH:mm:ss",nt="YYYY-MM-DD ";function tt(e=void 0,t=et){return Ie(e).format(t)}function ln(e=void 0,t=nt){return Ie(e).format(t)}const ot=we({props:["bordered","hiddenFilter","url","columns","actions","button","items","model","resKey","scroll"],setup(e){const{hasPermission:t}=jn(),{data:n,run:o,loading:u,current:g,pageSize:h,total:r,refresh:d}=xn(e.url,{pagination:{pageSizeKey:"limit",currentKey:"page"}}),y=j(()=>{var i;return(i=e.bordered)!=null?i:!0}),_=j(()=>{var i,p;return((p=n.value)==null?void 0:p[((i=e==null?void 0:e.resKey)==null?void 0:i.list)||"list"])||[]}),s=j(()=>({total:r.value,current:g.value,pageSize:h.value,showQuickJumper:!0,showSizeChanger:!0,showTotal:()=>Rn("span",{},`\u5171 ${r.value} \u6761`)})),k=(i,p,D)=>{o($({limit:i.pageSize,page:i==null?void 0:i.current,sortField:D.field,sortOrder:D.order},p))},S=j(()=>(Ye(e.actions)||[]).filter(i=>t(i.auth)).map(i=>{const{popConfirm:p}=i;return Ee($($({type:"link"},i),p||{}),{enable:!!p})})),T=j(()=>e.model),w=j(()=>e.button),K=j(()=>e.items);return{dataSource:_,loading:u,pagination:s,hasBordered:y,handleTableChange:k,run:o,refresh:d,getActions:S,tableFilterModel:T,tableFilterButton:w,tableFilterItems:K,onSearch:()=>{const i=Ye(T.value)||{};i&&Object.keys(i).map(p=>{i[p]&&Ie.isMoment(i[p])&&(i[p]=ln(i[p]))}),o($({page:g.value,limit:h.value},i))},formatDate:(i,p="date")=>{const D=p==="date"?ln:tt;return i.length===10?D(Number(i)*1e3):D(i)}}}}),at={class:"table-component"},rt=["type"],st=["onClick","type"];function lt(e,t,n,o,u,g){const h=Bn,r=Fn,d=Ln,y=Dn;return L(),oe("div",at,[ee(h,{button:e.tableFilterButton,items:e.tableFilterItems,model:e.tableFilterModel,hiddenFilter:e.hiddenFilter,pagination:null,onOnSearch:e.onSearch},null,8,["button","items","model","hiddenFilter","onOnSearch"]),ee(y,{class:Pn(["ant-table-striped",{border:e.hasBordered}]),rowClassName:(_,s)=>s%2==1?"table-striped":null,dataSource:e.dataSource,columns:e.columns,rowKey:_=>_.id,pagination:e.pagination,loading:e.loading,onChange:e.handleTableChange,scroll:e.scroll},{toDate:A(({text:_})=>[ke("span",null,ae(_?e.formatDate(_):"-"),1)]),toDateTime:A(({text:_})=>[ke("span",null,ae(_?e.formatDate(_,"time"):"-"),1)]),action:A(({record:_})=>[(L(!0),oe(Se,null,qe(e.getActions,(s,k)=>(L(),oe(Se,{key:`${k}-${s.label}`},[s.enable?(L(),H(r,{key:0,title:s==null?void 0:s.title,onConfirm:S=>s==null?void 0:s.onConfirm(_),onCancel:S=>s==null?void 0:s.onCancel(_)},{default:A(()=>[ke("a",{onClick:t[0]||(t[0]=$n(()=>{},["prevent"])),type:s.type},ae(s.label),9,rt)]),_:2},1032,["title","onConfirm","onCancel"])):(L(),oe("a",{key:1,onClick:S=>s==null?void 0:s.onClick(_),type:s.type},ae(s.label),9,st)),k<e.getActions.length-1?(L(),H(d,{key:2,type:"vertical"})):Ce("",!0)],64))),128))]),_:1},8,["class","rowClassName","dataSource","columns","rowKey","pagination","loading","onChange","scroll"])])}var ft=ze(ot,[["render",lt],["__scopeId","data-v-b69de9d8"]]);export{ft as _};
